const $ = document.querySelector.bind(document), $$ = document.querySelectorAll.bind(document), songName = $("#header__songName"), songAuthor = $("#header__songAuthor"), songImage = $("#songImage"), songImageWrap = $("#songImageWrap"), songListElement = $("#songList"), frontFace = $("#app__frontFace"), backFace = $("#app__backFace"), progress = $("#progress__range"), volumeBar = $("#listButton__volume-bar"), songListHTML = $("#songList"), songListButton = $("#listButton__list"), closeButton = $("#header__closeButton"), likeButton = $("#listButton__like"), playButton = $("#control__play"), prevButton = $("#control__previous"), nextButton = $("#control__next"), repeatButton = $("#listButton__repeat"), randomButton = $("#listButton__random"), volumeButton = $("#listButton__volume"), audioSong = $("#audioSong"), audioList = []; let durationSongList; const app = { currentIndex: 0, isLike: !1, isPlaying: !1, isRepeat: !1, isRandom: !1, isShowVolumeBar: !1, songs: [{ id: 0, name: "Anh chưa đủ tư cách", singer: "Lý Tuấn Kiệt", path: "./Resource/Audio/song-0.mp3", image: "./Resource/Image/songs/song-0.jpg", isLike: !1 }, { id: 1, name: "Anh đã khóc vì em", singer: "Đinh Tùng Huy", path: "./Resource/Audio/song-1.mp3", image: "./Resource/Image/songs/song-1.jpg", isLike: !1 }, { id: 2, name: "Vì anh quá thương em", singer: "Hải Nam", path: "./Resource/Audio/song-2.mp3", image: "./Resource/Image/songs/song-2.jpg", isLike: !1 }, { id: 3, name: "Cứ ngỡ", singer: "Hoài Bảo ft Hương Ly", path: "./Resource/Audio/song-3.mp3", image: "./Resource/Image/songs/song-3.jpg", isLike: !1 }, { id: 4, name: "Em nào có tội", singer: "Thương Võ", path: "./Resource/Audio/song-4.mp3", image: "./Resource/Image/songs/song-4.jpg", isLike: !1 }, { id: 5, name: "Họ yêu ai mất rồi", singer: "Doãn Hiếu", path: "./Resource/Audio/song-5.mp3", image: "./Resource/Image/songs/song-5.jpg", isLike: !1 }, { id: 6, name: "Hôm nay em cưới rồi", singer: "Khải Đăng", path: "./Resource/Audio/song-6.mp3", image: "./Resource/Image/songs/song-6.jpg", isLike: !1 }, { id: 7, name: "Người lạ thoáng qua", singer: "Đinh Tùng Huy", path: "./Resource/Audio/song-7.mp3", image: "./Resource/Image/songs/song-7.jpg", isLike: !1 }, { id: 8, name: "Phận duyên lỡ làng", singer: "Phát Huy t4", path: "./Resource/Audio/song-8.mp3", image: "./Resource/Image/songs/song-8.jpg", isLike: !1 }, { id: 9, name: "Thê Lương", singer: "Phúc Chinh", path: "./Resource/Audio/song-9.mp3", image: "./Resource/Image/songs/song-9.jpg", isLike: !1 }, { id: 10, name: "Cô đơn dành cho ai", singer: "Hồ Phi Nal", path: "./Resource/Audio/song-10.mp3", image: "./Resource/Image/songs/song-10.jpg", isLike: !1 }, { id: 11, name: "Cứ vội vàng", singer: "Roti", path: "./Resource/Audio/song-11.mp3", image: "./Resource/Image/songs/song-11.jpg", isLike: !1 }, { id: 12, name: "Em không hiểu", singer: "Changg x Minh Huy", path: "./Resource/Audio/song-12.mp3", image: "./Resource/Image/songs/song-12.jpg", isLike: !1 }, { id: 13, name: "Ghé qua", singer: "Dick X Tofu X PC", path: "./Resource/Audio/song-13.mp3", image: "./Resource/Image/songs/song-13.jpg", isLike: !1 }, { id: 14, name: "Lặng lẽ buông", singer: "Roti", path: "./Resource/Audio/song-14.mp3", image: "./Resource/Image/songs/song-14.jpg", isLike: !1 }, { id: 15, name: "Lần hẹn hò đầu tiên", singer: "Huyền Tâm Môn", path: "./Resource/Audio/song-15.mp3", image: "./Resource/Image/songs/song-15.jpg", isLike: !1 }, { id: 16, name: "Từng yêu", singer: "Phan Duy Anh", path: "./Resource/Audio/song-16.mp3", image: "./Resource/Image/songs/song-16.jpg", isLike: !1 }, { id: 17, name: "Lemon Tree", singer: "Fools Garden", path: "./Resource/Audio/song-17.mp3", image: "./Resource/Image/songs/song-17.jpg", isLike: !1 }], activeButton: function (n) { n && n.classList.add("activeButton") }, defineProperties: function () { Object.defineProperty(this, "currentSong", { get: function () { return this.songs[this.currentIndex] } }), Object.defineProperty(this, "songQuantity", { get: function () { return this.songs.length } }) }, handleEvent: function () { const n = songImage.animate([{ transform: "rotateZ(360deg)" }], { duration: 1e4, iterations: 1 / 0 }); n.pause(), songListButton.onclick = function () { frontFace.style.animation = "faceUp ease 0.6s forwards", backFace.style.animation = "faceUp ease 0.6s forwards" }, closeButton.onclick = function () { frontFace.style.animation = "faceDown ease 0.6s forwards", backFace.style.animation = "faceDown ease 0.6s forwards" }, likeButton.onclick = (() => { this.isLike = !this.isLike, this.updateIsLiked(this.isLike), likeButton.firstElementChild.classList.toggle("hidden"), likeButton.lastElementChild.classList.toggle("hidden") }), playButton.onclick = (() => { this.isPlaying = !this.isPlaying, this.isPlaying ? audioSong.play() : audioSong.pause() }), audioSong.onplaying = (() => { this.isPlaying = !0, n.play(), playButton.firstElementChild.classList.add("hidden"), playButton.lastElementChild.classList.remove("hidden") }), audioSong.onpause = function () { this.isPlaying = !1, n.pause(), playButton.firstElementChild.classList.remove("hidden"), playButton.lastElementChild.classList.add("hidden") }, prevButton.onclick = (() => { this.prevSong() }), nextButton.onclick = (() => { this.nextSong() }), repeatButton.onclick = (() => { this.isRepeat = !this.isRepeat, repeatButton.classList.toggle("activeButton", this.isRepeat) }), audioSong.ontimeupdate = function () { audioSong.duration && (progress.value = +audioSong.currentTime / audioSong.duration * 100) }, audioSong.onended = (() => { this.endedSong() }), progress.onchange = function (n) { audioSong.duration && (audioSong.currentTime = +n.target.value / 100 * audioSong.duration) }, randomButton.onclick = (() => { this.isRandom = !this.isRandom, randomButton.classList.toggle("activeButton", this.isRandom) }), volumeButton.onclick = function () { volumeBar.classList.toggle("hidden", this.isShowVolumeBar), this.isShowVolumeBar = !this.isShowVolumeBar }, volumeBar.onclick = function (n) { n.stopPropagation() }, volumeBar.oninput = function () { audioSong.volume = this.value / 100 }, songListHTML.onclick = (n => { const e = n.target.closest(".songList__item:not(.activeSong"); e && this.playSongByIndex(+e.dataset.index) }) }, playSongByIndex: function (n) { this.loadSongByIndex(this.currentIndex = n), audioSong.play() }, playSong: function () { this.loadSongByIndex(this.currentIndex), audioSong.play() }, resetLikeButton: function () { this.isLike = !1, likeButton.firstElementChild.classList.remove("hidden"), likeButton.lastElementChild.classList.add("hidden") }, updateIsLiked: function (n) { for (let e of $$(".songList__item")) if (+e.dataset.index === this.currentIndex) { const i = e.children[1].children[0]; n ? (i.classList.remove("hidden"), this.songs[this.currentIndex].isLike = !0) : (i.classList.add("hidden"), this.songs[this.currentIndex].isLike = !1) } }, randomSong: function () { if (this.isRandom) { let n; do { n = ~~(this.songQuantity * Math.random()) } while (this.currentIndex === n); this.currentIndex = n } }, render: function () { for (let n = 0; n < this.songQuantity; n++)audioList.push(`./Resource/Audio/song-${n}.mp3`); const n = this.songs.map((n, e) => { const i = new Audio(audioList[e]); return i.preload = "metadata", i.onloadedmetadata = function () { durationSongList[e].textContent = secondToMinute(this.duration) }, `\n                <li id="songList__item" class="songList__item" data-index="${e}">\n                <div class="songList__item-information">\n                    <h5 class="songList__item-songName">${n.name}</h5>\n                    <h6 class="songList__item-author">${n.singer}</h6>\n                </div>\n                <div class="songList__item-status">\n                    <i class="songList__item-iconIsLiked hidden fas fa-heart"></i>\n                    <i class="songList__item-iconIsPlaying hidden fas fa-music"></i>\n                    <div class="songList__item-duration">${i.duration}</div>\n                </div>\n                </li>\n            ` }); songListElement.innerHTML = n.join(""), durationSongList = $$(".songList__item-duration") }, activeSong: function () { const n = $$(".songList__item"); for (let e of n) { const n = e.children[1].children[1]; +e.dataset.index === this.currentIndex ? (n && n.classList.remove("hidden"), e.classList.add("activeSong"), e.classList.add("activeSong")) : (n && n.classList.add("hidden"), e.classList.remove("activeSong")) } }, endedSong: function () { this.isRepeat ? audioSong.play() : this.nextSong() }, prevSong: function () { this.isRandom ? this.randomSong() : --this.currentIndex < 0 && (this.currentIndex = this.songs.length - 1), this.loadSongByIndex(this.currentIndex), audioSong.play() }, nextSong: function () { this.isRandom ? this.randomSong() : ++this.currentIndex >= this.songs.length && (this.currentIndex = 0), this.loadSongByIndex(this.currentIndex), audioSong.play() }, loadSongByIndex: function (n) { songName.textContent = this.songs[n].name, songAuthor.textContent = this.songs[n].singer, songImage.style.backgroundImage = `url('${this.songs[n].image}')`, audioSong.src = this.songs[n].path, this.activeSong(), this.resetLikeButton() }, start: function () { this.defineProperties(), this.render(), this.handleEvent(), this.loadSongByIndex(this.currentIndex) } }; function secondToMinute(n) { return [n % 3600 / 60, n % 60].map(n => `0${Math.floor(n)}`.slice(-2)).join(":") } app.start();
